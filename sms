async function loadData() {
    let token = getTokenFromUrl();
    let res = await api.getKeyInfo(token);
    if (!res.data) {
        alert("卡密不存在");
        return;
    }
    tbKkey = res.data;
    document.getElementById("phone").value = res.data.phone || "未获取";
    document.getElementById("code").value = res.data.code || "未收到验证码";
    
    switch (res.data.statu) {
        case 1: // 未取号
            document.getElementById("getPhone").style.display = "";
            document.getElementById("copyPhone").style.display = "none";
            document.getElementById("changePhone").style.display = "none";
            document.getElementById("code").value = "请获取号码";
            break;
        case 2: // 已取号，未收到验证码
            document.getElementById("getPhone").style.display = "none";
            document.getElementById("copyPhone").style.display = "";
            document.getElementById("changePhone").style.display = "";
            document.getElementById("code").value = "正在获取短信...";
            break;
        case 3: // 已收到验证码，token 失效
            document.getElementById("getPhone").style.display = "none";
            document.getElementById("copyPhone").style.display = "";
            document.getElementById("changePhone").style.display = "none";
            document.getElementById("copyCode").style.display = ""; // 显示复制验证码按钮
            clearInterval(pollInterval); // 停止轮询
            break;
    }
}

let pollInterval = setInterval(async () => {
    if (tbKkey.statu === 2) {
        await api.getCode(getTokenFromUrl());
        loadData();
    }
}, 3000);
